\documentclass[a4paper,12pt,titlepage]{article}
\usepackage[utf8]{inputenc}
\usepackage{a4wide}
\usepackage[czech]{babel}
\usepackage{amsfonts, amsmath, amsthm, amssymb}
\usepackage[small,compact]{titlesec}
\usepackage{anyfontsize}
\usepackage{rotating}
\usepackage{mdwlist}

\newcommand{\shn}{\Theta}
\newcommand{\lm}{\smallskip\noindent\bf Lemma\rm{} }
\newcommand{\dk}{\smallskip\noindent\bf Důkaz\rm{} }
\newcommand{\df}{\smallskip\noindent\bf Definice\rm{} }
\newcommand{\vt}{\smallskip\noindent\bf Věta\rm{} }
\newcommand{\poz}{\smallskip\noindent\bf Pozorování\rm{} }
\newcommand{\dsl}{\smallskip\noindent\bf Důsledek\rm{} }
\newcommand{\tvr}{\smallskip\noindent\bf Tvrzení\rm{} }
\newcommand{\F}{\mathcal{F}}
\newcommand{\B}{\mathcal{B}}
\newcommand{\A}{\mathcal{A}}
\renewcommand{\L}{\mathcal{L}}
\newcommand{\Fr}{\mathbb{F}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\xttt}{{\chi_T^\bot}^T}
\newcommand{\todo}[1]{\bf TODO: \rm#1}
\renewcommand{\L}{\mathcal{L}}
%\newcommand{\qed}{\hfill QED}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\Ker}{Ker}
\newcommand\bigzero{\makebox(0,0){\text{\huge0}}}
\newcommand\bigone{\makebox(0,0){\text{\huge1}}}
\newcommand{\bigddots}[1]{\makebox(0,0){\rotatebox{-35}{\text{\xleaders\hbox{$\cdot$\hskip4pt}\hskip#1\kern0pt}}}}
\newcommand{\sk}[1]{\langle #1\rangle}
\newcommand{\diagdots}[3][-25]{%
  \rotatebox{#1}{\makebox[0pt]{\makebox[#2]{\xleaders\hbox{$\cdot$\hskip#3}\hfill\kern0pt}}}%
}

\title{Linearní Algebra v Kombinatorice}
\author{Ladislav Láska\\ Jan Musílek}

\begin{document}

\maketitle
\newpage
\tableofcontents
\newpage


\section{Lineární nezávislost}
\df Vektory $v_i$ jsou lineárně nezávislé, pokud existuje netriviální řešení 
rovnice $\sum_i \alpha_iv_i=0$.
\subsection{Sudo-licho města}
\df Nechť $|X|=n$ a $A_1, \dots, A_m \subseteq X$ jsou neprázdné podmnožiny.  
Úloha A-B město se ptá, jak velké může být $m$, pokud $|A_i| \sim B$ a $|A_i\cap 
A_j|\sim A$ (tedy pro sudo-licho město máme omezení na liché velikosti a sudé 
průniky).

\vt Pro úlohu sudo-licho město platí $m \leq n$.

\dk Počítejme nad $GF(2)$. Matice $A$ nechť je charakteristická matice dimenze 
$n \times m$. Podívejme se na součin $AA^T$, tedy na matici skalárních součinů:
\begin{align}
	AA^T = \left(\begin{matrix}A_1\\ A_2 \\ \vdots \\ A_m \end{matrix}\right) 
	\cdot \left(\begin{matrix}A_1, A_2, \dots, A_m\end{matrix}\right) =
	\left(\begin{matrix}
	1 & &\bigzero & \\
	& \ddots && \\
	&\bigzero& \ddots & \\
	&&  &1
	\end{matrix}\right)
\end{align}
Tedy víme, že $\rank(AA^T) = m$ a $\rank(A) \leq n$. Z vlastností ranku již 
snadno získáme nerovnost $m=\rank(AA^T) \leq \rank(A) \leq n$. \todo{důkaz 
rankové nerovnosti obrázkem pomocí zobrazení} \qed

\vt Nechť $|X|=n$ a $A_1, \dots, A_m \subseteq X$ že platí $|A_i \cap A_j| = 1 $ 
a $A_i \neq A_j$. Potom $m \leq n$.
\dk Podobně jako v předchozím příkladě vezměme matici charakteristických vektorů 
$A$ a podívejme se na součit $AA^T$, tentokrát již nad $Q$:
\begin{align}
	AA^T = \left(\begin{matrix}
	|A_1| & &\bigone & \\
	& \ddots && \\
	&\bigone& \ddots & \\
	&&  &|A_m|
	\end{matrix}\right)
\end{align}
Dále označme $a_i := |A_i|$. Můžeme předpokládat, že $a_1 \leq a_2 \leq \dots 
\leq a_m$. Zřejmě také $a_2 > 1$ (jinak $A_1 = A_2$). Nyní bychom chtěli 
dokázat, že je matice regulární -- proto se podíváme na determinant této matice:
\begin{align}
	|AA^T| = \left|\left(\begin{matrix}
	a_1 & &\bigone & \\
	& \ddots && \\
	&\bigone& \ddots & \\
	&&  &a_m
	\end{matrix}\right)\right|
	%= \left|\begin{matrix}\text{{\fontsize{120}{120}\selectfont 1}}\end{matrix}
	= \left|\begin{matrix}\text{\bf\Huge 1}\end{matrix}
	+\left(\begin{matrix}
	a_1-1 & &\bigzero & \\
	& \ddots && \\
	&\bigzero& \ddots & \\
	&&  &a_m-1
	\end{matrix}\right)\right|
\end{align}
Zatímco matice jedniček je singulární \todo{Pochopit proč se to dá spočítat, ale 
determinant vyjde kladně}.  \qed

\subsection{Dvouvzdálenostní množiny}
\vt $P_1, P_2, \dots, P_m$ jsou body v $\R^n$ a $\exists \alpha, \beta \in \R$ t. že $\|P_iP_j\| \in {\alpha, \beta}$. Pak $m(n) \leq {(n+1)(n+4)\over 2}$.

\dk
\begin{align}
F(x,y) = (\|x,y\|^2-\alpha^2)(\|x,y\|)-\beta^2)&\qquad F: (\R^n \rightarrow \R) \\
f_i(x) = F(x, P_i)&\qquad f_i: \R^n \rightarrow \R
\end{align}

Když jsou $f_1, f_2, \dots, f_m$ lineárně nezávislé, pak $m \leq \dim($prostor funkcí $\R^n \rightarrow \R)$. Lineární kombinace $\sum_{i=1}^m \gamma_if_i(x) = 0$.

\begin{align}
f_i(P_j) &= \alpha^2\beta^2&\qquad {\rm pro}\ i=j\\
f_i(P_j) &= 0&\qquad {\rm pro}\ i\neq j
\end{align}

\begin{align}
\forall j: \sum_{i=1}^m \gamma_if_i(P_j) = \alpha^2\beta^2\gamma_j = 0 \qquad\Rightarrow\qquad \forall j: \gamma_j = 0
\end{align}

Z toho plyne, že funkce $f_1, f_2, \dots f_m$ jsou lineárně nezávislé.

\begin{align}
f_i(x) &= ((x_1-p_1)^2+\dots+(x_n-p_n)^2-\alpha^2) ((x_1-p_1)^2+\dots+(x_n-p_n)^2-\beta^2) \\
&= (x_1^2+\dots+x_n^2-2p_1x_1-\dots-2p_nx_n-\alpha^2) (x_1^2+\dots-2p_1x_1-\dots-\beta^2)
\end{align}

$p_i^2$ se ztratí do $\alpha$ a $\beta$. Následuj rozbor případů po roznásobení:

\begin{align}
	&(x_1^2+\dots+x_n^2)(x_1^2+\dots+x_n^2) &\qquad 1\\
	&(x_1^2+\dots+x_n^2)x_i &\qquad n\\
	&x_i^2 &\qquad n\\
	&x_ix_j &\qquad {n \choose 2}\\
	&x_i &\qquad n\\
	&1 &\qquad 1\\
\end{align}

Případ $(x_1^2+\dots+x_n^2)$ není potřeba, vyjádříme ho jako kombinaci $x_i^2$. Velikost lineárního obalu:

$${n\choose 2} + 3n + 2 = {n(n-1) \over 2} + {6n\over 2} + {4\over 2} = {n^2-5nn+4 \over 2} = {(n+1)(n+4)\over 2}$$ \qed


\vt Pro dvouvzdálenostní množinu na kouli platí: $${n(n+1)\over 2} \leq m_{sf}(n) \leq {n(n+3)\over 2}$$

\dk

{\bf Horní odhad} (ostatní řádky nepotřebujeme, $(x_1^2 + \dots + x_n^2)$ se na kouli posčítá na konstantu):
\begin{align}
	&x_i^2 &\qquad n\\
	&x_ix_j &\qquad {n \choose 2}\\
	&x_i &\qquad n\\
\end{align}

$${n\choose 2} + 2n = {n(n-1)\over 2} + {4n\over 2} = {n^2+3n\over 2} = {n(n+3) \over 2}$$

{\bf Dolní odhad} (konstrukce 2-vzdálenostní množiny v $\R^n$):

Body budou všechny vektory délky $n$ s dvěma jedničkovými souřadnicemi. Vzdálenost dvou bodů s $1$ na různých souřadnicích je $2$, zatímco vzdálenost bodů které se v jedné souřadnici shodují je $\sqrt 2$.

Uvažujme nyní body v $\R^{n+1}$ místo v $\R^n$. Takových je $n+1 \choose 2$. 

\bigskip
$\sum x_i^2 = 2 \Rightarrow$ všechny body leží na sféře\footnote{$x_i$ je $i$-tá souřadnice bodu $x$}\\
\indent$\sum x_i = 2 \Rightarrow$ všechny body leží v nadrovině \\

$$\left\{x | \sum x_i = 2 \right\} \cap \R^{n+1} \simeq \R^n$$

Tedy máme 2-vzdálenostní množinu $n+1 \choose 2$ bodů na kouli v $\R^n$.


\subsection{Dolní odhad na Ramseyovo číslo}
\vt (Ramsey) $\forall n\ \exists N\ \forall G$ na $\ge N$ vrcholech má $\omega(G) \ge n$ nebo $\alpha(G) \ge n$.

Víme, že $R_2(n) = \min N \le {2n-2\choose n-1}$. Konstrukcí si ukážeme dolní odhad.

\vt $R_2(n) \ge {n-1\choose 3}$

\dk $|X| = n-1$. Zkonstruujeme $G=\left(V={X\choose 3}, E=\{ab: |a\cap b|=1, a,b\in V\}\right)$.

Klika v $G$ je {\it skorodisjunktní systém podmnožin} $X$ $\Rightarrow$ $\omega(G) \le |X| = n-1$.

Vrcholy jsou nezávislé, pokud $|a\cap b| \in \{0,2\}$ a velikost nezávislé množiny 
v $G$ je tedy {\it sudo-licho město} $\Rightarrow$ $\alpha(G) \le |X| = n-1$.
\qed


\subsection{Fisherova nerovnost}

\section{Skalární součin}

Mějme vektorový prostor $V = T^n$.

\df (Skalární součin) $\sk{x,y} = \sum x_iy_i$ \quad(= $\sum x_i\overline{y_i}$ nad $\C$)

\subsection{Ortogonální doplněk}

\df $M \subseteq T^n$ \quad $M^\bot = \{x\ |\ \forall a\in M: \sk{x,a} = 0\}$ je ortogonální doplněk $M$.

Zjevně platí $\dim M^\bot = n - \dim \sk M$

\poz ${(M^\bot)}^\bot = \sk M$

\dk přes dimenze\quad $n-(n-k) = k = \dim M$ \qed

\df (Součet podprostorů) $\sk{M\cup N} = \sk M + \sk N$

$$\dim\left(\sk M + \sk N\right) + \dim\left(\sk M \cap \sk N\right) = \dim \sk M + \dim \sk N$$

\dsl Podprostory $M,N << T^n: \dim M + \dim N > n \Rightarrow \dim M \cap N \ge 1$ $\Rightarrow$ $\exists u \neq 0, u \in M\cap N$.
Pro tělesa, ve kterých platí $\sk{x,x} \neq 0$ pro $x\neq 0$ platí:
$$M << T^n \Rightarrow M\cap M^\bot = \{0\} \Rightarrow \dim(M+M^\bot) = n \Rightarrow M + M^\bot = T^n$$

\subsection{Sudo-sudo města}

\df $|X| = n$, $A_1, A_2, \dots A_k \subseteq X$, $|A_i| \equiv 0 \mod 2$, $|A_i\cap A_j| \equiv 0 \mod 2$. Jaké největší může být $k = k(n)$?

\vt $k(n) \ge 2^{n\over 2}$

\dk Utvoříme páry -- $2^{n\over 2}$ je počet podmnožin $n\over 2$ prvkové množiny. \qed

\vt $k(n) \le {n\over 2}$

\dk\footnote{$A_i$ budeme považovat za charakteristický vektor podmnožiny $A_i$
v množině $X$.} $A_i \in GF(2^n)$. Nechť $M$ je maximální (co do inkluze)
sudo-sudo město. Pak $M$ je vektorový prostor:
\begin{align}
	&\emptyset \in M \\
	&\forall u \in M, \forall c\in GF(2): c\cdot u \in M \\
	&\forall x,u,v\in M: \sk{x, u+v} = \sk{x,u} + \sk{x,v} = 0 + 0 = 0 \\
	&\forall u,v \in M: \sk{u+v,u+v} = \sk{u,u} + 2\sk{u,v} + \sk{v,v} = 0 + 0 + 0 = 0
\end{align}

Když $M << GF(2)^n$ a $\dim M = k$, pak $|M| = 2^k$. Vektory mají sudé průniky {\it (sudo-sudo město)} nad $GF(2)$ a tedy platí $\forall x,y\in M: \sk{x,y} = 0$.

$$\forall x\in M: x\in M^\bot \quad\Rightarrow\quad M\subseteq M^\bot \quad\Rightarrow\quad \dim M \le \dim M^\bot$$

$$k = \dim M \le \dim M^\bot = n-k \quad\Rightarrow\quad 2k \le n \quad\Rightarrow\quad k \le {n\over 2}$$
\qed

\subsection{Eulerovské a úplné bipartitní podgrafy}

$G = (V,E)$ je souvislý graf. $V_G = \{$ spanning\footnote{Česky též \uv{napnuté} -- podgrafy obsahující všechny vrcholy grafu $G$ (i kdyby některé z nich byly izolované).} podgrafy $G$ $\}$

\tvr $V_G$ je vektorový prostor nad $GF(2)$ s operací symetrická diference. $V_H \in GF(2)^E$

\bigskip
\todo Obrázek se symetrickou diferencí podgrafů.
\bigskip

\df $\varepsilon_G = \{ $ eulerovské podgrafy $\equiv
\forall $ stupně sudé $ \}$. Součtem dvou eulerovských podgrafů je eulerovský
podgraf, tvoří tedy podprostor $V_G$.

\lm $\dim \varepsilon_G = |E| - n + 1$

\dk Vybereme si libovolnou kostru $T$ grafu $G$. Pro každou hranu, která není v
kostře existuje právě jedna elementární kružnice $K_e$ určená touto hranou. $\{
K_e\ |\ e \in E(G) - E(T) \}$ tvoří lineárně nezávislé vektory. Lze dokázat,
že tvoří bázi $\varepsilon_G$.

Z toho $\dim \varepsilon_G = |E| - n + 1$, což je počet hran mimo kostru. \qed

\df $\beta_G = \{$ úplné bipartitní spanning podgrafy $G$ $\}$. $\beta_G$ je
prostor všech řezů v $G$.

\lm $\beta_G << V_G$, $\beta_G = \langle\{$ hvězdy $\}\rangle$

\bigskip
\todo Zmatený důkaz obrázkem.
\bigskip


\vt $\varepsilon_G^\bot = \beta_G$

\dk $H \in \varepsilon_G, u \in V$. $H_u$ je hvězda z vrcholu $u$. $\sk{H,H_u} = \deg_H u$

$H \in \varepsilon_G \Rightarrow \forall u: \sk{H,H_u} = 0 \Rightarrow \forall B\in \beta_G: \sk{H,B} = 0 \Rightarrow H \in \beta_G^\bot \Rightarrow \varepsilon_G \subseteq \beta_G^\bot$

$H$: $\forall B\in \beta_G: \sk{H,B} = 0 \Rightarrow $H je kolmé na všechny hvězdy $\forall u: \sk{H,H_u} = 0$ \\ $\Rightarrow \forall u: \deg_H u \equiv 0 \mod 2 \Rightarrow H \in \varepsilon_G \Rightarrow \beta_G^\bot \subseteq \varepsilon_G$

Tedy $\varepsilon_G = \beta_G^\bot$, protože $\varepsilon_B^\bot = {\left(\beta_G^\bot\right)}^\bot = \beta_G$.
\qed

$\dim \varepsilon_G = \dim \beta_G^\bot = |E| - n + 1$.


\vt $M \subseteq GF(2)^n \quad\Rightarrow\quad (1,1,\dots,1) \in \sk M + M^\bot = \sk{M\cup M^\bot}$

\dk $\sk M \cap M^\bot$
\begin{enumerate}
\item[(a)] $\dim(\sk M + M^\bot) = 0 \quad\Rightarrow\quad \dim(\sk M + M^\bot) = k+n-k = n \Rightarrow \sk M + M^\bot = GF(2)^n \Rightarrow (1,1,\dots,1)\in \sk M + M^\bot$
\item[(b)] $\dim(\sk M + M^\bot) > 0 \quad\Rightarrow\quad \exists u\in \sk M \cap M^\bot$ \\ 
$\forall u\in \sk M \cap M^\bot: \sk{u,u} = 0 \Rightarrow \sum u_i^2 \equiv 0 \mod 2 = \sum u_i = \sk{u, (1,1,\dots,1)}$ \\
nad $GF(2)$ platí $u_i^2 = u_i$ \\
$\Rightarrow (1,1,\dots,1) \in {(\sk M \cap M^\bot)}^\bot = {\sk M}^\bot + {(M^\bot)}^\bot = M^\bot + \sk M$
\end{enumerate}
\qed


% zjistit znak pro disjunktní sjednocení
\vt $\forall G \ \exists V_1,V_2,\ V_1\cup^\cdot V_2 = V(G)$ t. že $G[V_1]$ i $G[V_2]$ mají všechny stupně sudé.

\dk $M = \varepsilon_G << V_G$

$G = (1,1,\dots,1) \in \varepsilon_G + \varepsilon_G^\bot = \varepsilon_G + \beta_G$
\qed

Důsledkem je, že $\exists H \in \varepsilon_G\ \exists B\in \beta_G: G = H + B$ (tedy každý graf lze zapsat jako symetrickou diferenci eulerovského podgrafu a hranového řezu).


\section{Shannonova kapacita a Lovászova $\vartheta$ funkce}
\subsection{Shannonova kapacita}
$$
	\shn(G) = \sup_i(\alpha(G_i))^{1/i}
$$

\lm $\shn(G + \overline{G}) \geq \sqrt{2|G|}$

\dk 
\begin{align}
	\alpha ((G+\overline G)^2) \geq 2|G| \\
	V_{G+\overline G} = \{ V_1, ..., V_n, V_1', ..., V_n'\}
\end{align}
Lze vzít nezávislou množinu $A$:
\begin{align}
	A = (V_i, V_i'), (V_i', V_i)
\end{align}
\qed


\subsection{Funkční reprezentace grafu}
\df Nechť $G$ je graf, $\F$ je systém funkcí, $X$ množina reprezentantů. Pak pro vrchol $v$ mějme $f_v \in \F$, že $f_v X \to \F$ a :
\begin{enumerate}
	\item $f_v(c_v) \neq 0$
	\item $uv \notin E_G \Rightarrow f_u(c_v) = 0$
\end{enumerate}

\df Dimenzi $\F$ definujeme jako $\dim\L(\{f_v\})$, tedy chápeme funkce jako vektorový prostor.


\lm(L) G má reprezentaci $\F$, pak $\shn(G) \leq \dim \F$.

\lm(A) G má reprezentaci $\F$, pak $\alpha(G) \leq \dim \F$.\par
\dk Nechť $A$ je nezávislá v $G$. Vyhodnotím reprezentující funkci v bodech $A$.
\begin{align}
\left(
	\begin{matrix}
		f_1(c_1) & f_2(c_2) & \dots \\
		f_2(c_1) & f_2(c_2) & \dots \\
		\vdots &&\\
	\end{matrix}\right)
\end{align}
Tedy všechny reprezentující funkce jsou lineárně nezávislé, tedy je lemma dokázáno.\qed

\lm(B) Pokud $G_1$ má reprezentaci $\F_1$, $G_2$ reprezentaci $\F_2$ nad stejným tělesem, pak $G = G_1 \boxtimes G_2$ má reprezentaci $\F$ a $\dim\F \leq \dim\F_1 \cdot \dim\F_2$.

\dk Definuji $X = X_1 \cup^.$, $c_(v_1,v_2) = (c_{v_1}, c_{v_2})$ a $f_(v_1, v_2) = f_{v_1}(x_1) \cdot f_{v_2}(x_2)$.
Dále stačí ověřit, že platí axiomy a víme, že je to korektně definovaná reprezentace. Stačí omezit dimenzi, stačí ale nahlédnout, že nové funkce jsou lineární kombinací vektorů z nanejvýš dvou bazí, výše uvedená nerovnost tedy platí.\qed

\dk(L) $\shn(G) = \sup_i \alpha(G^i)^{1/i} \leq^{LA} \sup_i(\dim f.r.(G^i))^{1/i} \leq^{LB} \sup_i\dim f.r. (G)^{1/i} = \dim f.r.(G)$

\vt Existuje $G, H$, že $\shn(G+H) > \shn(G) + \shn(H)$.
\dk Zvolím $G$ takový, že $V_G=\binom{S}{3}$, $S = \{1, ..., s\}$ a $E_G = \{ (A, B) | |A\cap B| = 1\}$. Reprezentaci vytvoříme nad tělesem $\Fr = \Z_2$, $C_A = char. vektor A$ a $f_A(x) = \sum_{a\in A} X_a$.

Ověříme, že je o reprezentace. Navíc každá funkce, kterou máme, je nějaká kombinace tří funkcí $b_i(X) = x_i$, těch je $s$.

Dále pro $\overline G$: $\Fr = \R$, $X = \R^s$, $c_A = char. vektor A$, $f_A(x) = \left(\sum_{a\in A} x_a\right) -1$. Nahlédneme stejně jako v předchozím případě, že jde o reprezentaci a dim $\leq s+1$.

Nyní zvolíme $s$ takové, že $\sqrt{2\binom{s}{3}} > 2s + 1$ a věta platí \todo{rozmyslet}. \qed

\df Obecná poloha vektorů množiny \v N v  $\R^d$ je taková, že libovolná podmnožina velikosti $\leq d$ je lineárně nezávislá.

\df Lokálně obecná poloha vektorů reprezentace v $\R^d$ na grafu $G$ jsou takové vrcholy, že $\rho(\overline{N(v)})$ jsou lineárně nezávislé.

\vt Pro $G$ s $|G| = n$ jsou ekvivalentní tyto tvrzení:
\begin{enumerate}
	\item $G$ má ortogonální reprezentaci v $\R^d$ v obecné poloze.
	\item $G$ má ortogonální reprezentaci v $\R^d$ v lokálně obecné poloze.
	\item $G$ je $(n-d)$-souvislý.
\end{enumerate}


\section{Vlastní čísla grafu}
\subsection{Moorovy grafy}
Motivací nechť jsou r-regulární grafy bez krátkých cyklů (troj- a 
čtyř-úhelníků). Triviální konstrukce nám dává odhad na počet vrcholů:
\todo{obrázek konstrukce}
\begin{align}
\label{moorova-podminka}
	|V| \geq 1 + r + r(r-1) = r^2 +1
\end{align}

\df Moorův graf je takový $r$-regulární graf bez troj- a čtyř-úhelníků, kde 
platí v (\ref{moorova-podminka}) rovnost.

\vt Moorův graf existuje pro $r=1,2,3,7$, pro $r=57$ se neví a pro žádné další 
$r$ neexistuje.

\dk (Idea) Mějme graf $G$ Moorův a $A$ jeho matici sousednosti. Zapišme druhou 
mocninu $A$ jako stupeň na diagonále a prohozené 0 a 1 jinde a upravme:
\begin{align}
	&A^2 = rE + {\bf0} + {\bf1}(J- A-E) \\
	&A^2 = rE - J - A - E \\
	\label{moorova-matice}&A^2 + A + (1-r)E = J
\end{align}
Dále pro nějaké $\lambda\in \Sp(A)$:
\begin{align}
	\label{moorova-mocnina}A^2 x = AAx = A\lambda x = \lambda A x = \lambda 
	\lambda x = \lambda^2 x
\end{align}
A dosadíme (\ref{moorova-matice}) za $A$:
\begin{align}
	Jx = (A^2 + A + (1-r)E)x = (\lambda^2 + \lambda + (1-r))x
\end{align}
A tedy $(\lambda^2 + \lambda + 1 -r) \in \Sp(J)$. Vlastní čísla matice $J$ 
(matice samých jedniček) ale známe, jsou to $\{0^{(n-1)}, n^{(1)}\}$. Zjevně pro 
$\lambda = r$ vyjde vlastní číslo $n$, je tedy potřeba vyřešit kvadratickou 
rovnici s parametrem $r$:
\begin{align}
	\lambda^2 + \lambda + 1 - r = 0
\end{align}
Jak na to půjdeme? Vyjádříme si $\lambda$ známým vzorečkem pro kořeny:
\begin{align}
	\lambda_{1,2} = \frac{-1\pm \sqrt{1-4(1-r)}}{2} = \frac{-1\pm\sqrt{4r-3}}{2}
\end{align}
Násobnost označíme $m_1, m_2$. Protože stopa matice je suma vlastních čísel 
včetně násobností, platí dále rovnice (protože matice sousednosti $A$ má na 
diagonále vždy nuly):
\begin{align}
	\Tr(A) = r+m_1\lambda_1 + m_2\lambda_2 = 0
\end{align}
Pro další úravy označme odmocninu z diskriminantu jako $\sqrt{\cdot}$. Nejdříve 
upravíme do formy (násobení dvěma a přeskupení):
\begin{align}
	2r - r^2 + \sqrt{.}(m_1 - m_2) = 0
\end{align}
Všimneme si, že $r\in\N$, tedy máme dvě možnosti:
\begin{enumerate}
	\item $\sqrt{.} \in \Q$: potom $m_1 = m_2$ a tedy $r = 2$.
	\item $\sqrt{.} = s^2 \in \Q$ a $s \in \N$. Po menších úpravách lze zjistit, 
	že $s\in \{1, 3, 5, 15\}$, což dává $r\in\{1, 3,7,57\}$.
\end{enumerate}
\qed

\subsection{Silně regulární grafy}

\df Silně regulární graf je d-regulární, $\forall$ hranu $xy\in E$ $\exists!e$
vrcholů $u: ux,uy\in E$ a $\forall$ nehranu $xy\not\in E$ $\exists!f$ vrcholů
$u: ux,uy\in E$.

Abychom mohli zanedbat triviální případy, dodáváme $f>0$ a $G\neq K_n$.
Příkladem silně regulárního grafu je úplný bipartitní graf se stejně velkými
partitami ($e=0$). Nejmenším nebipartitním silně regulárním grafem je
pětiúhelník ($e=0$, $f=1$).

\vt $G$ je silně regulární graf s parametry $d$, $e$, $f$ a $n$ vrcholy. Potom:
\begin{enumerate}
	\item[(a)] Zafixujeme $f$. $e = f-1$; $d = 2f$; $n = 4f+1$
	\item[] {\it nebo}
	\item[(b)] $(e-f)^2-4(f-d) = s^2 \qquad \exists s\in \Z$ \\
	a ${d\over 2fs}((d-1+f-e)(s+f-e)-2f) \in \N$
\end{enumerate}

\dk Nechť G je silně regulární, $A$ je jeho matice sousednosti. $(A^2)_{ij} =
e$, pokud $A_{ij} = 1$. Na ostatních souřadnících bude $f$, na diagonále $d$
(to plyne z jednoduchého pozorování počtu sledů délky 2).

$$
A^2 = \left(
	\begin{matrix}
		d & & f & \\
		& d & & e \\
		f & & \ddots & \\
		& e & & d\\
	\end{matrix}\right)
$$

\begin{align}
	A^2 = dI + eA + f(J-I-A) &= fJ + (d-f)I + (e-f)A \\
	A^2 + (f-e)A + (f-d)I &= fJ \\
	\lambda^2 + (f-e)\lambda + (f-d) &\rightarrow \Sp(fJ)\qquad \lambda\in\Sp A
\end{align}

Víme, že vlastní čísla jedničkové matice $J$ jsou $\Sp(J) = \{n, 0^{n-1}\}$.
Proto $\Sp(fJ) = \{fn, 0^{n-1}\}$. Dále víme, že $d$ je vlastním číslem matice
$A$, neboť graf $G$ je $d$-regulární.

\begin{align}
	&d^2 + (f-e)d + (f-d) \in \Sp(fJ) \\
	&d^2 + (f-e)d + (f-d) = fn \\
\end{align}
\begin{align}
	&\lambda \in \Sp(A) - \{d\} \Rightarrow \lambda^2 + (f-e)\lambda + (f-d) = 0 \\
	&\lambda_{1,2} = {e-f \pm \sqrt{(f-e)^2-4(f-d)} \over 2} \qquad \sqrt{(f-e)^2-4(f-d)} = s
\end{align}

$$\lambda_1 = {e-f+s\over 2}\qquad\qquad \lambda_2 = {e-f-s\over 2}$$

Matice $A$ má vlastní čísla $d$ (1-násobné), $\lambda_1$ ($p$-násobné) a
$\lambda_2$ ($q$-násobné).

\begin{enumerate}
	\item[(1)] $1 + p + q = n$ (celkový počet vlastních čísel)

	\item[(2)] $d + p\lambda_1 + q\lambda_2 = \Tr A = 0$ (stopa\footnote{Stopou (čtvercové) matice rozumíme součet čísel na diagonále. Je známo, že součet vlastních čísel (včetně násobností) je roven stopě matice. Značíme ji $\Tr A$.} matice $A$ je 0) \\
	$d + p\left({e-f+s\over 2}\right) + q\left({e-f-s\over 2}\right) = 0$ \\
	$d + \left({p+q\over 2}\right)(e-f) + \left({s\over 2}\right)(p-q) = 0$

	\item[(3)] $d^2 + p\lambda_1^2 + q\lambda_2^2 = \Tr A^2 = nd$ (vlastní čísla matice $A^2$ jsou druhé mocniny vlastních čísel matice $A$).
\end{enumerate}

\begin{enumerate}
	\item[(a)] $s\not\in Q \Rightarrow p = q$ \quad $d + p(e-f) = 0 \Rightarrow p = {d\over f-e} \Rightarrow (f-e)|d$ \\
	$f-e > 0$ \quad $n = 1 + 2p = 1 + {2d\over f-e}$ \quad (z rovnice (1))

	Pokud $f-e = 1$, pak $e = f-1$ (což chceme). \\
	Pokud $f-e = 2$, pak $n = 1+d$ a $G = K_{d+1}$, ale úplné grafy jsme si zakázali. \\
	Pokud $f-e > 2$, pak $n < 1+d$, což je nesmysl.

	$e = f-1 \quad\Rightarrow\quad n = 2d+1$ \\
	$d^2 + d + (f-d) = f(2d+1) \quad\Rightarrow\quad d = 2f \quad\Rightarrow\quad n = 4f+1$

	\item[(b)] $s\not\in\Q\Rightarrow s\in\N$ \\
	\todo Prý pokračování na cvičení, nemůžu ho ale najít. \\
	$$p = {d\over 2fs}\left((d-1+f-e)(s+f-e)-2f\right) \in \N$$
\end{enumerate}
\qed


\vt (Friendship theorem) $G$ má vlastnost $e = f = 1$. Pak $\exists u: \deg(u) = n-1$.

Friendship theorem tvrdí, že takový silně regulární graf musí vypadat jako
mlýn (hromádka trojúhelníků, které se stýkají v jednom centrálním vrcholu).

\dk $(V(G), \{N(u), u\in V(G)\}) = \B$ množinový systém.

$u \in N(w) \wedge v \in N(w) \Rightarrow \exists uw, \exists vw$ \\
\indent $\forall u\neq v\ \exists!\ N(w) \ni u,v$ \\
\indent $\forall u\neq v\ |N(u)\cap N(v)| = 1$

Z výše uvedeného vyplývá, že $\B$ tvoří konečnou projektivní rovinu.

\subsection{Raileighův princip a proplétání}
\vt (Raileighův princip) Nechť $A$ je matice s ortogonální bazí z vlastních 
vektorů $x_i$ a vlastními čísly $\lambda_i \geq \lambda_k$. Potom $x \in\langle 
x_1,\dots,x_k\rangle \Rightarrow x^TAx\geq x^T\lambda_kx$.

\vt (Věta o proplétání) Nechť $A$ a $B$ jsou matice takové, že $B$ vznikla z $A$ 
vymazáním nějakého řádku a sloupce. Potom pro vlastní čísla $\lambda_i,\mu_i$ 
matic $A,B$ platí:
\begin{align}
	\lambda_1 \geq \mu_1 \geq \lambda_2 \geq \dots\geq \mu_{n-1} \geq \lambda_n
\end{align}

\dk Dokazujeme indukcí $\lambda_k \geq \mu_k \geq \lambda_{k+1}$. Označme $x_i$ 
a $y_i$ vlastní vektory matic $A$ a $B$.  Zaveďme následující vektorové 
podprostory $\C^n$ (ačkoli druhý z nich nemá dostatek složek, můžeme mu jednu 
nulovou přidat a nic se nestane):
\begin{align}
S_1 := \L\{x_k, \dots, x_n\} \subseteq \C^n \\
S_2 := \L\{y_1, \dots, y_k\} \subseteq \C^n
\end{align}
Zřejmě $\dim(S_1) + \dim(S_2) > n$, tedy $\exists x \in S_1\cap S_2$. Použijeme 
Reileighův princip pro oba prostory a máme:
\begin{align}
	\mu_k \leq \frac{y^*By}{y^*y} = \frac{x^*Ax}{x^*x} \leq \lambda_k
\end{align}
Stačí ukázat, že $\mu_k \geq \lambda_{k+1}$ -- to je ale snadné, stačí vzít $-A$ 
a $-B$, čímž se obrátí znaménka vlastních čísel a nerovnosti. \qed

\vt (Věta o proplétání podobných matic) Nechť $A$ je symetrická čtvercová matice 
s vlastními čísly a vektory $\lambda_i$ a $x_i$, $S$ reálná matice, že $S^TS=I$.  
Definujeme $B := S^TAB$ a označíme vlastní čísla a vektory matice $B$ jako 
$\mu_i$ a $y_i$. Potom $\mu_i$ proplétají $\lambda_i$ a pokud navíc $\mu_i = 
\lambda_i$ pro nějaké $i$, tak $Sy_i$ je vlastní vektor $A$ příslušící vlastnímu 
číslu $\lambda_i$.

\dk Použijeme Raileighův princip podobně, jako v předchozím tvrzení. Všimneme 
si, že:
\begin{align}
	x \in \L\{ S^Tx_k, \dots, S^Tx_{k-1}\}^\perp \Leftrightarrow
	Sx \in \L\{ x_k, \dots, x_{k-1}\}^\perp
\end{align}
Stačí si opět vzít vhodný prvek $x$ z průniku:
\begin{align}
	x \in \L\{ S^Tx_k, \dots, S^Tx_{k-1}\}^\perp \cap \L\{y_1, \dots, y_k\}
\end{align}
A můžeme použít Reileighův princip:
\begin{align}
	\lambda_i \geq \frac{Sx^TASx}{Sx^TSx} = \frac{x^TBx}{x^Tx} \geq \mu_i \\
\end{align}
Na navíc platí pokud $\lambda_i = \mu_i$, potom:
\begin{align}
	\frac{x^TBx}{x^Tx} = \lambda_i \quad\Rightarrow\quad x^TBx=x^Tx\lambda_i 
	\quad\Rightarrow\quad Bx = \lambda_i x
\end{align}
A $x$ je vlastní vektor příslušící $\lambda_i$, jak jsme chtěli dokázat.\qed



\section{Náhodné procházky}
\subsection{Markovovy řetězce}
\subsection{Stabilní distribuce a konvergence}

\section{Expandéry}

\df
\begin{itemize}
	\item $E(S,T) = \{$ hrany mezi $S$ a $T$ $\}$
	\item $e(S,T) = |E(S,T)|$
	\item $e(S) = $ počet hran uvnitř $S$
	\item vrcholová expanze $h_v(G) = \min\limits_{S\subseteq V, |S|\le {n\over 2}} {|N(S) \over |S|}$
	\item hranová expanze $h(G) = \min\limits_{S\subseteq V, |S|\le {n\over 2}} {e(S,\bar S) \over |S|}$
\end{itemize}

\poz $h_v(G) \le h(G) \le d . h_v(G)$

\df 
\begin{itemize}
	\item Rodina expanderů $\{G_i\}_\infty$\quad$2^i \ge |G_i| \ge i: h(G_i) \ge \varepsilon$, $G_i$ je $d$-regulární.
	\item Spectral gap $= d - \max\{\lambda_2,-\lambda_n\}$
	\item Spektrální expanze $= d - \lambda_2$
	\item $\lambda = \max\{\lambda_2,-\lambda_n\}$
\end{itemize}

\vt ${1\over 2}(d-\lambda_2) \le h(G) \le \sqrt{d(d-\lambda_2)}$ (G je $d$-regulární graf).

\dk (Jen první nerovnost, druhá je bez důkazu). Sporem: nechť $S$ je množina
vrcholů s malou hranovou expanzí.

Pro $x \bot (1,1,\dots,1)$ platí $\lambda_2 \ge {x^TAx\over x^Tx}$ (Raileighův
princip). Zvolíme $x = (n-s)1_S - s1_{\bar S}$, kde $s = |S|$ a $1_S$ je
charakteristický vektor množiny $S$.

$$x^Tx = (n-s)^2s + s^2(n-s) = s(n-s)n$$
$$x^TAx = \sum_{(a,b)\in E} 2x_ax_b = 2(n-s)^2e(S)-2s(n-s)e(S,\bar S) + 2s^2e(\bar S)$$

Platí $ds = 2e(S) + e(S,\bar S)$, neboť $ds$ odpovídá počtu konců hran v $S$. Analogicky $d(n-s) = 2e(\bar S) + e(S,\bar S)$ pro $\bar S$. Z toho si vyjádříme $e(S)$ a $e(\bar S)$ a dosadíme do rovnice výše:

$$x^TAx = -e(S,\bar S)n^2 + (n-s)ds(n-s+s) = (n-s)dsn - e(S,\bar S)n^2$$
$$\lambda_2 \ge {(n-s)dsn - e(S,\bar S)n^2 \over s(n-s)n} = d - {n\over n-s}\cdot{e(S,\bar S)\over s}$$
$$d-\lambda_2 \le {n\over n-s} \cdot {e(S,\bar S)\over s} \le 2\cdot{e(S,\bar S)\over s} = 2h(G)$$
\qed

\lm Pro náhodný d-regulární graf skoro jistě platí $\lambda \le 2\sqrt{d-1} + O(1)$. Bez důkazu.

\subsection{Mixing lemma}
\vt (Mixing lemma) $\forall G, \forall S,T \subseteq V, S\cap T = \emptyset: |e(S,T) - {d\cdot|S|\cdot|T|\over n}| \le \lambda\cdot\sqrt{|S|\cdot|T|}$

\dk Buďte $\chi_S, \chi_T$ charakteristické vektory $S$ a $T$. $u = (1,1,\dots)$ je první vlastní vektor. $\chi_S^\bot$ značí vektor kolmý na $\chi_S$.

$${\sk{\chi_S \cdot u} \over \|u\|^2} = {|S|\over n} \qquad\Rightarrow\qquad \chi_S = u\cdot {|S|\over n} + \chi_S^\bot \qquad\qquad \chi_T = u\cdot {|T|\over n} + \chi_T^\bot$$

$$e(S,T) = \sum_{i\in S, j\in T} A_{ij} = \chi_T^TA\chi_S = \underbrace{{|S|\cdot |T| \over n^2} \underbrace{u^TAu}_{dn}}_{d\cdot |S|\cdot |T|\over n} + \xttt A\chi_s^\bot$$

Zbývá dokázat, že $|\xttt A\chi_S^\bot| \le \lambda\cdot\sqrt{|S|\cdot |T|}$.

$$|\xttt A\chi_S^\bot| \le \|\xttt \| \cdot \|A\chi_S^\bot\| \le \|\xttt\|\cdot\lambda\cdot\|\chi_S^\bot\|$$

První nerovnost plyne z toho, že skalární součin dvou vektorů (tedy součin
jejich délek a sinu úhlu, který svírají) je vždy nejvýš roven součinu jejich
délek. Druhá nerovnost plyne z toho, že si $\chi_S^\bot$ můžu vyjádřit jako
lineární kombinaci vlastních vektorů $A$:

$$\chi_S^\bot = \sum_{i=2}^n y_i\alpha_i$$

Pro každý vlastní vektor $y_i$ můžu nahradit matici $A$ vlastním číslem
$\lambda_i$ (pak bude zachována rovnost) a tím spíš můžu nahradit matici $A$
největším vlastním číslem, což je v našem případě $\lambda =
\max\{\lambda_2,-\lambda_n\}$, abych zachoval nerovnost.

$$\|\chi_S\|^2 = |S| \qquad\Rightarrow\qquad \|\xttt\| \le \sqrt S$$
$$\|\chi_T\|^2 = |T| \qquad\Rightarrow\qquad \|\chi_S^\bot\| \le \sqrt T$$

$$|\xttt A\chi_S^\bot| \le \lambda\cdot\sqrt{|S|\cdot |T|}$$
\qed


\subsection{Vzdálenostní mocniny a zig-zag součin}

\section{Perfektní kódy}
\subsection{Vzdálenostně regulární grafy}

\df Vzdálenostně regulární graf: $\exists s_{hij}$ t. že $\forall u,v\in V(G), d_G(u,v) = j:$ $|\{w: d_G(u,w) = h, d_G(w,v) = i\}| = s_{hij}$.

\poz $|h-j| > j \Rightarrow s_{hij} = 0$ (plyne z $\Delta$ nerovnosti), $k = s_{110}$ (počet sousedů vrcholu $u = v$ v $k$-regulárním grafu)

\lm $Z_{mi} = Z_{m-1,i-1} \cdot s_{1,i-1,i} + Z_{m-1,i} \cdot s_{1,i,i} + Z_{m-1,i+1} \cdot s_{1,i+1,i}.$ $Z_{mi}$ značí počet sledů délky $m$ mezi vrcholy ve vzdálenosti $i$.

\dk $Z_{00} = 1$, jinak $Z_{0i} = 0$. Dále dokážeme indukcí pro $m \ge 1$ a $i
\ge 1$. $s_{1,i,j}$ je nenulové pouze pro $i \in \{j-1,j,j+1\}$ (z $\Delta$
nerovnosti). V rovnici sčítáme vrcholy sousedící s $u$, které jsou ve
vzdálenosti $i-1$, $i$ a $i+1$ od $v$.

\df Matice sousednosti $A = A_G$. $\A(G) = \{p(A): p(x) \in \C[x]\}$. $\A(G)$ je
vektorový prostor.

\df Vzdálenostní matice $A_1, A_2, \dots, A_d$ grafu $G$: \\
\indent $(A_i)_{uv} = \left\{\begin{matrix}
1\quad & d_G(u,v) = i \hfill & \hspace{4cm} A_0 = I \\
0\quad & \text{jinak} \hfill & \hspace{4cm} A_1 = A \\
\end{matrix}\right.$

\vt $\dim \A(G) = d+1$, kde $d$ je průměr $G$.\footnote{Průměr grafu je maximální nejkratší vzdálenost přes všechny dvojice vrcholů.}

\dk $A^m = \sum_{i=0}^d Z_{mi}A_i$ \\
$i > m \Rightarrow Z_{mi} = 0$ \\
$A^0 = Z_{0,0} \cdot A_0 = A_0$\\
$A^1 = Z_{1,0} \cdot A_0 + Z_{1,1} \cdot A_1 = A_1$\\
$A^2 = Z_{2,0} \cdot A_0 + Z_{2,1} \cdot A_1 + Z_{2,2} \cdot A_2$\\
$\vdots$\\
$A^d = Z_{d,0} \cdot A_0 + Z_{d,1} + \dots + Z_{d,d}\cdot A_d$

Generujeme celý vektorový prostor polynomů $A$ $\deg \le d$, tedy $\dim \A(G)
\le d+1$. Zároveň ale $A_0, A_1, \dots, A_d$ jsou lineárně nezávislé a proto
$\dim \A(G) = d+1$. 
\qed

\poz $\widetilde \A = \{A_0, A_1, \dots, A_d\}$ tvoří bázi $\A(G)$.



\df Matice $B_h$ pro graf je velikosti $d\times d$, uchovávající parametry $s_hij$:
\begin{align}
	(B_h)_{i,j} := s_{hij}
\end{align}
Maticí $B$ navíc rozumíme matici $B_1$.

\lm Existuje funkce $f: \A \to \A$, že $f(A_h) = B_h$ a tuto operaci značíme $\widehat A = B$.

\dk Z předchozího lemmatu již máme bázi $\widetilde{\A}$ prostoru $\A$. Ukážeme si tedy, že můžeme přejít k bázi z menších matic $B$. Nejdříve si všiměme, co se děje v následujícím součinu matic:

\begin{align}
	(A_hA_i)_{uv} = \sum_w(A_h)_{uw} \cdot (A_i)_{wv} = s_{hid(u,v)}
\end{align}

Kde zmíněná suma je rozpis maticového násobení pro jednu buňku součinu. Zřejmě přičtu $1$ pokaždé, když pro vrchol $w$ platí, že $d(u,w)=h$ a $d(w,v) = i$, což je přesně definice $s_{hij}$ pro $j = d(u,v)$. Jak takový prvek ještě můžeme vyjádřit (rozepsáním maticového násobení s použitím předchozího vzorce pro buňku)?

\begin{align}
	A_hA_i = \sum_{j=0}^d s_{hij} A_j
\end{align}

Což je vlastně lineární kombinace prvků z báze s koeficienty $s_{hij}$. Vytvořme tedy novou bázi, například takovou, která bude obsahovat právě tyto koeficienty. Do řádku $i$ matice $B'_h$ zapíšeme souřadnice součinu $A_hA_i$, tedy $s_{hij}$. Tím získáme matice $B_i$, které jsou bazí (vytvořili jsme je zapsáním souřadnic lineárně nezávislých prvků a tak jsou lineárně nezávislé), která navíc splňuje žádané vlastnosti a tedy $B'_h = B_h$. \qed



\lm (o sousedech) $B1 = \left(\begin{matrix}
& & & & & & & & \bigzero & \\
& & & & & & & & & \\
& \bigzero & & & & {\smash{\raisebox{.75\normalbaselineskip}{\diagdots{9em}{.5em}}}} & {\smash{\raisebox{1.2\normalbaselineskip}{\diagdots{6.5em}{.5em}}}} & \\
& & & & {\smash{\raisebox{1.3\normalbaselineskip}{\diagdots{6.5em}{.5em}}}} & & \\
\end{matrix}\right)$ je tridiagonální matice. Všechny sloupcové součty jsou stejné a jsou rovny $k$.

\dk Matice je tridiagonální, protože $s_{1,i,j}$ dává smysl jen pro $i \in \{j-1,j,j+1\}$ (z $\Delta$ nerovnosti). Navíc v $j$-tém sloupci je $s_{1,j-1,j} + s_{1,j,j} + s_{1,j+1,j}$, což zahrnuje všechny sousedy $u$, kterých je $k$.
\qed


\lm $B1 = \left(\begin{matrix}
& & & & & & & & \bigzero & \\
& & & & & & & & & \\
& \bigzero & & & & {\smash{\raisebox{.75\normalbaselineskip}{\diagdots{9em}{.5em}}}} & {\smash{\raisebox{1.2\normalbaselineskip}{\diagdots{6.5em}{.5em}}}} & \\
& & & & {\smash{\raisebox{1.3\normalbaselineskip}{\diagdots{6.5em}{.5em}}}} & & \\
\end{matrix}\right)$ je tridiagonální matice $\Rightarrow$ $\forall$ vlastní čísla jsou různá.

\df Definujme polynomy $v_i \in \Q[\lambda]$ takové, že $\deg v_i(\lambda) = i$ a:
\begin{enumerate} 
	\item $v_0(\lambda) = 1$
	\item $v_1(\lambda) = \lambda$
	\item pro $i \in \{ 2, \dots, d-1\}$ induktivně, aby splňovaly rovnici 
	\begin{align}
		(s_{1,i,i-1} v_{i-1}(\lambda)) + (s_{1,i,i-\lambda}v_i(\lambda)) + (s_{1,i,i+1}v_{i+1}(\lambda)) = 0
	\end{align}
\end{enumerate}


\lm Nechť $\lambda_1,\ldots,\lambda_d \in \Sp(B_1)$. Potom pokud $\lambda_i \neq k$ platí:
\begin{align}
	v_o(\lambda) + \ldots + v_d(\lambda) = c \cdot (\lambda - \lambda_1) \cdot \ldots \cdot (\lambda - \lambda_d)
\end{align}

\dk Vytvořme vektor $\vec{v} = (v_1(\lambda), \ldots, v_d(\lambda))$ a uvažme systém rovnic $B\vec{v} = \lambda \vec{v}$. Ten umíme řešit po řádcích (známe první dva členy vektoru a celou matici obsahující potřebné koeficienty), známe tedy vlastní čísla (kořeny této rovnice) a jejich vlastní vektory (obsahují složky $v_i(\lambda)$.

Nejprve si ukážeme, že jedno z vlastních čísel je $k$ (všimněte si, že v předpokladech používáme $d$ vlastních čísel, ale dimenze matice $B$ je $d+1$). Vezměme si výše používaný systém rovnic a sečtěme levé a pravé strany. Podle Lemma o sousedech jsou sloupcové součty matice $B$ rovny $k$, získáme tedy rovnici $k(v_0(\lambda) + \ldots + v_d(\lambda)) = \lambda (v_0(\lambda) + \ldots + v_d(\lambda))$, z čehož po úpravě plyne, že $\lambda = k$.

\todo{Rovnost s char. polynomem}

\lm Pro polynomy $v_i$ platí, že $v_i(A) = A_i$ a $v_i(B) = B_i$.

\dk {\it(bez důkazu)}


\df $z\in V(G)$, $T\in\{0,1\}^{d+1 \times n}$\\
\indent $T_{i,u} = \left\{\begin{matrix}
1\quad & d(u,z) = i\hfill \\
0\quad & \text{jinak}\hfill
\end{matrix}\right.$

\lm (o zastřešování) $X\in\A(G), z\in V(G) \Rightarrow TX = \widehat XT$

\dk 
\begin{align*}
(TA)_{iu} &= \sum_w T_{iw}A_{wu} = s_{1,i,d(u,z)} \\
(BT)_{iu} &= \sum_j B_{ij}T_{ju} = s_{1,i,d(u,z)} \\
TA = BT \quad&\Rightarrow\quad TA^2 = BTA = B^2T \quad\Rightarrow\quad TA^m = B^mT \\
Tp(A) = p(B)T \quad&\Rightarrow\quad TX = \widehat XT
\end{align*}
\qed

\df $x_i(\lambda) = v_0(\lambda) + \dots + v_i(\lambda)$ \hfil $S_t = x_t(A) = A_0 + A_1 + \dots + A_t$

\lm $C$ je perfektní kód (množina vrcholů) v $G$ a $c$ je jeho charakteristický vektor. Pak $S_t\cdot c = \vec 1$.

\dk $(S_t\cdot c)_u = |\{w: w\in C, d(w,u) \le t\}| = 1$, což plyne z definice perfektního kódu.
\qed

\lm $\exists$ $t$-perfektní kód $\Rightarrow$ $\dim \Ker \widehat S_t \ge t$

\dk $z_0 = z \in C$

$z_1,z_2,\dots,z_t \quad d(z,z_i) = i$ pro $i = 1,2,\dots,t$

$(T_{z_i} \cdot c)_j = \delta_{ij}$ (Kroneckerovo delta $= 1$ pro $i=j$, $0$ jinak)

Tedy vektory $T_{z_i} \cdot c$ pro $i = 0, 1, \dots, t$ jsou lineárně nezávislé.

\begin{align*}
	&\widehat S_t(T_{z_i}\cdot c) = (\widehat S_t \cdot T_{z_i}) \cdot c \overset{1}{=} T_{z_i} \cdot S_t \cdot c \overset{2}{=} T_{z_i}\cdot \vec 1 = \left(\begin{matrix}
		k_0 \\ \vdots \\ k_d
	\end{matrix}\right) \\
\end{align*}

$\overset{1}{=}$ plyne z lemma o zastřešování, $\overset{2}{=}$ plyne z předchozího lemmatu.

\begin{align*}
	&u_i = T_{z_i}\cdot c - T_{z_0}\cdot c\qquad i = 1, 2, \dots, t \\
	&\widehat S_t u_i = \widehat S_t T_{z_i}\cdot c - \widehat S_t T_{z_i}\cdot c = \left(\begin{matrix}k_0 \\ \vdots \\ k_d\end{matrix}\right) - \left(\begin{matrix}k_0 \\ \vdots \\ k_d\end{matrix}\right) = \vec 0 \quad\Rightarrow\quad u_i\in\Ker \widehat S_t\\
\end{align*}

Vektory $u_1,\dots, u_t$ tvoří $\Ker \widehat S_t$ a jsou lineárně nezávislé. Tedy $\dim\Ker\widehat S_t \ge t$.
\qed








\subsection{Lloydova věta}


\end{document}

